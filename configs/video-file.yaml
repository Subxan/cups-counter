# Example config for using a video file as input source
# Set camera.source to "opencv" and camera.index to the video file path

camera:
  source: "opencv"                    # Use opencv source for video files
  index: "./data/test_video.mp4"      # Path to video file (relative or absolute)
  width: 1280                         # Fallback if video properties can't be read
  height: 720
  fps: 30                             # Fallback if video FPS can't be read
  rotate: 0

model:
  hef_path: "./models/yolov8n_coco.hef"
  class_filter: ["cup"]
  conf_thresh: 0.35
  iou_thresh: 0.45
  max_detections: 50
  mock_mode: false

tracking:
  type: "bytetrack"
  track_thresh: 0.50
  match_thresh: 0.80
  min_box_area: 150
  lost_ttl: 30

counting:
  line:
    start: [100, 360]
    end:   [1180, 360]
  direction: "bar_to_counter"
  hysteresis_px: 6
  min_visible_frames: 3

storage:
  sqlite_path: "./data/cups.db"
  csv_dir: "./data/exports"
  export_daily_time: "23:59"
  wal_mode: true

ui:
  http_port: 8080
  preview: true
  draw_overlays: true
  timezone: "Asia/Baku"

ops:
  save_debug_video: false
  debug_dir: "./debug"
  metrics_port: 9109
  log_level: "INFO"

autocal:
  enabled: false                     # Disable auto-cal for video files
  warmup_seconds: 120
  propose_top_k: 3
  auto_apply_if_confident: false
  min_flow_ratio: 0.6
  save_debug: true

roi:
  enabled: true
  band_height_px: 140
  margin_px: 24

drift:
  enabled: false                     # Disable drift monitoring for video files
  ssim_threshold: 0.90
  edge_iou_threshold: 0.70
  brightness_var_min: 6.0
  re_calibrate_on_drift: true
  min_minutes_between_recal: 60

tuner:
  enabled: false                     # Disable tuner for video files
  run_time: "03:10"
  clip_seconds: 90
  grid:
    conf_thresh: [0.30, 0.35, 0.40]
    match_thresh: [0.75, 0.80, 0.85]
    min_box_area: [120, 150, 180]
  optimize_for: "stable_crossings"
  keep_best_profile: true

audit:
  thumbnails_per_day: 50
  thumb_size: [128, 128]

pos:
  recon_enabled: true
  pos_csv_dir: "./data/pos"

